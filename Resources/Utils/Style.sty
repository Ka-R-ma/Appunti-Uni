\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{Style}

%%-----------------------------------------------------------------------------
%%------------------------------- Packages List -------------------------------
%%-----------------------------------------------------------------------------
\RequirePackage[usernames, x11names]{xcolor}
\RequirePackage[hidelinks]{hyperref}
\RequirePackage[italian]{babel}
\RequirePackage{fancyhdr}
\RequirePackage[a4paper, left = 72pt, right = 72pt, top = 72pt, bottom = 72pt, twoside, includeall]{geometry}
\RequirePackage[explicit, compact]{titlesec}
\RequirePackage{amssymb}
\RequirePackage{amsthm}
\RequirePackage{mathdots}
\RequirePackage{mathrsfs}
\RequirePackage{tikz}
\RequirePackage{forest}
\RequirePackage{listings}
\RequirePackage{lstautogobble}
\RequirePackage{graphicx}
\RequirePackage{wrapfig}
\RequirePackage{caption}
\RequirePackage{subcaption}
\RequirePackage{setspace}
\RequirePackage{subfiles}

%%-----------------------------------------------------------------------------
%%------------------------------- Math settings -------------------------------
%%-----------------------------------------------------------------------------
\everydisplay{\color{SkyBlue4}}
\everymath{\color{SkyBlue4}}
\DeclareMathSizes{11pt}{10pt}{5pt}{3.5pt}


\makeatletter
\g@addto@macro\normalsize{%
    \setlength\abovedisplayskip{6.75 pt}
    \setlength\belowdisplayskip{6.75 pt}
    \setlength\abovedisplayshortskip{2.5pt}
    \setlength\belowdisplayshortskip{2.5pt}
}
\makeatother

%%-----------------------------------------------------------------------------
%%-------------------------------- Page Option --------------------------------
%%-----------------------------------------------------------------------------
\pagestyle{fancy}
\renewcommand{\sectionmark}[1]{\markboth{#1}{}}
\fancyhead[LO]{\textbf{Sezione \thesection:} \leftmark}
\fancyhead[RE]{\textbf{Sezione \thesection:} \leftmark}
\fancyhead[LE, RO]{}
\fancyfoot[C]{-- {\thepage} --}

\setlength{\oddsidemargin}{10pt}
\setlength{\evensidemargin}{75pt}
\setlength{\textwidth}{371pt}
\setlength{\topmargin}{15pt}
\setlength{\headheight}{15pt}
\setlength{\headsep}{15pt}
\setlength{\marginparpush}{10pt}
\setlength{\marginparwidth}{65pt}
\setlength{\marginparsep}{11pt}
\renewcommand{\headrulewidth}{0.25pt}
\renewcommand{\footrulewidth}{0.25pt}
\renewcommand{\headwidth}{447.25pt}

\titleformat{\section}[hang]{\LARGE\bfseries}{-- {\thesection} -- }{5pt}{#1.}
\titleformat{\subsection}[hang]{\Large\bfseries}{-- {\thesubsection} -- }{5pt}{#1.}
\titleformat{\subsubsection}[hang]{\large\bfseries}{-- {\thesubsubsection} -- }{5pt}{#1.}
\titleformat{\paragraph}[hang]{\normalsize\bfseries}{-- {\theparagraph} -- }{5pt}{#1.}
\titlespacing*{\section}{0pt}{2.5pt}{2.5pt}
\titlespacing*{\subsection}{0pt}{2.5pt}{2.5pt}
\titlespacing*{\subsubsection}{0pt}{2.5pt}{2.5pt}
\titlespacing*{\paragraph}{0pt}{2.5pt}{2.5pt}

\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{2}

\let\TOC\tableofcontents
\renewcommand{\tableofcontents}{%
    {\newgeometry{marginparwidth = 0pt, left = 1in, right = 1in, top = 1in, bottom = 1in, asymmetric} \thispagestyle{plain} \TOC \clearpage} \restoregeometry
}

%%-----------------------------------------------------------------------------
%%---------------------------- Custom Environments ----------------------------
%%-----------------------------------------------------------------------------
\ProvideDocumentEnvironment{MarginNote}{+b}{
    \marginpar{
        \setstretch{0.7}\footnotesize{\textbf{Nota: }#1}
    }
}{}

%%-----------------------------------------------------------------------------
%%%%-------------------------- Numbered Environments --------------------------
%%-----------------------------------------------------------------------------
\newtheoremstyle{Emphasised}{\abovedisplayshortskip}{0pt}{\itshape}{}{\bfseries}{.}{ }{\thmname{#1}\thmnumber{ #2}}

\theoremstyle{Emphasised}
\newtheorem{Proposition}{Proposizione}
\newtheorem{Theorem}{Teorema}[section]
\newtheorem{Corollary}{Corollario}[Theorem]
\newtheorem{Lemma}{Lemma}[Theorem]
%%-----------------------------------------------------------------------------
%%%%------------------------ Non-Numbered Environments ------------------------
%%-----------------------------------------------------------------------------
\newtheoremstyle{Definition*}{\abovedisplayshortskip}{0pt}{}{}{\bfseries}{:}{ }{\thmname{#1}}

\theoremstyle{Definition*}
\newtheorem{Definition*}{Definizione}
\newtheorem{Example*}{Esempio}
\newtheorem{Axiom*}{Assioma}

\newtheoremstyle{Remark*}{0pt}{0pt}{}{}{\bfseries}{.}{ }{\thmname{#1}}

\theoremstyle{Remark*}
\newtheorem{Remark*}{Osservazione}
\newtheorem{Note*}{Nota}

\newtheoremstyle{Proof*}{0pt}{0pt}{}{\parindent}{\itshape}{:}{ }{\thmname{#1}}

\theoremstyle{Proof*}
\newtheorem{Proof*}{Dimostrazione}

\newtheoremstyle{Emphasised*}{\abovedisplayshortskip}{0pt}{}{}{\bfseries}{.}{ }{\thmname{#1}\thmnote{ #3}}

\theoremstyle{Emphasised*}
\newtheorem{Algorithm*}{Algoritmo}
\newtheorem{Theorem*}{Teorema}
\newtheorem{Property*}{Propriet√†}
\newtheorem{Law*}{Legge}

%%-----------------------------------------------------------------------------
%%---------------------- Adjusting Existing Environments ----------------------
%%-----------------------------------------------------------------------------
\AtBeginEnvironment{tabular}{\color{black}}
\AtBeginEnvironment{minipage}{\color{black}}

\AtEndEnvironment{equation}{\label{Eq:\theequation}}
\AtEndEnvironment{Proposition}{\label{Prop:\theProposition}}
\AtEndEnvironment{Theorem}{\label{Thm:\theTheorem}}
\AtEndEnvironment{Corollary}{\label{Corol:\theCorollary}}
\AtEndEnvironment{Lemma}{\label{Lemma:\theLemma}}
\AtEndEnvironment{Proof}{\qed}
\AtEndEnvironment{itemize}{\noindent}
\AtEndEnvironment{enumerate}{\noindent}

\captionsetup[subfigure]{labelformat = simple, labelsep = colon}
\renewcommand\thesubfigure{\thefigure.\alph{subfigure}}


%%-----------------------------------------------------------------------------
%%-------------------------- Tikz & related settings --------------------------
%%-----------------------------------------------------------------------------
\usetikzlibrary{
    angles,
    arrows.meta,
    quotes,
    patterns,
    calc,
    automata,
    positioning,
    decorations.pathmorphing
}
\lstset{
    autogobble = true,
    frame = single,
    frameround = tttt,
    mathescape,
    basicstyle = \scriptsize,
    linewidth = 0.75\textwidth,
    breaklines = true,
    xleftmargin = \parindent,
    escapeinside={__*}{*__}
}

\lstdefinelanguage{PSEUDO}{
    keywords = {if, then, else, for, do, while, true, false, and, AND, or, OR, not, NOT, xor, XOR},
    keywordstyle = \bfseries
}


%%-----------------------------------------------------------------------------
%%------------------------------- Other Options -------------------------------
%%-----------------------------------------------------------------------------
\newcommand{\sectionbreak}{\clearpage}